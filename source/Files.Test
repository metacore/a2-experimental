# Files.Mod tests
#
# Available operations:
#
#	Files.Old <filename>
#	Files.New <filename>
#
#	File.Length <expectedLength>
#	File.Read
#	File.ReadBytes <offset> <length>
#	File.Write
#	File.WriteBytes <offset> <length>
#	File.Set <position>
#	File.Pos
#
#	Reader.SetPos <position>
#	Reader.Pos <position>
#	Reader.Get
#	Reader.Bytes <offset> <size> <len>
#
#	DELETE <filename> deletes file if it exists. Does not cause errors!
#
#	ASSERT <variable> <operator> <value>
#	SET <variable> TO <value>
#
#	Integer variables: rider.res, reader.res, readerBytesLength
#	Integer operators: =, #, >, >=, <, <=
#
#	Boolean variables: rider.eof
#	Boolean operators: =, #
#
#	Character variables: byte, buffer[index]
#	Character operators: =, #
#
#	String variables: buffer
#	String operators: =, #
#
#	INITBUFFER 0 sets buffer to NIL
#	INITBUFFER n creates a buffer of length n and fills it with 0X
#

### Tester self-test

negative: Self-test assert fails

	SET rider.res TO 0
	ASSERT rider.res # 0

negative: Self-test comments

	# This is a comment
	SET rider.res TO 0
	# This assert should fail
	ASSERT rider.res # 0

positive: Self-test: Set integer variables

	SET rider.res TO -1
	ASSERT rider.res = -1
	SET rider.res TO 99
	ASSERT rider.res = 99
	SET readerBytesLength TO -1
	ASSERT readerBytesLength = -1
	SET readerBytesLength TO 0
	ASSERT readerBytesLength = 0

positive: Self-test: Set boolean variables

	SET rider.eof TO TRUE
	ASSERT rider.eof = TRUE
	SET rider.eof TO FALSE
	ASSERT rider.eof = FALSE

positive: Self-test: Set character variables

	SET byte TO 1
	ASSERT byte = 1
	SET byte TO 0
	ASSERT byte = 0

negative: Self-test: Write to non-existing buffer

	SET buffer TO "Hello World"

negative: Self-test: Write into too small buffer

	INITBUFFER 5
	SET buffer TO "HELLOX"

positive: Self-test: Write into exactly fitting buffer

	INITBUFFER 5
	SET buffer TO "HELLO"

negative: Self-test: Buffer has been set to NIL after last test

	SET buffer TO "X"
	
negative: Self-test: Set buffer to NIL by setting it's length to zero

	INITBUFFER 4
	INITBUFFER 0
	SET buffer TO "X"
	
positive: Self_test: Set bytes by using buffer index

	INITBUFFER 5
	SET buffer[0] TO H
	SET buffer[1] TO E
	SET buffer[2] TO L
	SET buffer[3] TO L
	SET buffer[4] TO O
	ASSERT buffer[0] = H
	ASSERT buffer[4] = O
	ASSERT buffer = HELLO

negative: Self_test: Out-of-bounds access

	INITBUFFER 5
	SET buffer[5] TO X

### Basic file tests

positive: open existing file

	Files.Old TestFile0.Bin

negative: open non-existing file

	Files.Old ThisFileShouldNotExists.Bin

positive: check length of file

	Files.Old TestFile0.Bin
	File.Length 0

positive: create non-existing file

	DELETE NonExistingFile.Bin
	Files.New NonExistingFile.Bin
	DELETE NonExistingFile.Bin

positive: create existing file

	Files.New ExistingFile.Bin
	REGISTER
	Files.New ExistingFile.Bin
	REGISTER

### File position tests

positive: set position to zero

	Files.Old TestFile0.Bin
	File.Set 0
	ASSERT rider.res = 0

positive: set negative position

	Files.Old TestFile0.Bin
	File.Set -1
	ASSERT rider.res = 0
	File.Pos 0
	File.Length 0

positive: set position after end of file

	Files.Old TestFile0.Bin
	File.Set 1000
	ASSERT rider.res = 0
	File.Pos 0
	File.Length 0


